#include "ecg.h"

uint16_t data[30] = {0};

uint16_t mqttdata[13] = {0,1,2,3,4,5,6,7,8,9,10,11,12};
uint8_t mqttindex = 0;
uint8_t mqttcompleteflag = 0;

int16_t ecgdata[3000] = {167,164,166,167,155,173,146,170,194,146,177,170,136,150,165,185,169,179,180,185,168,168,185,193,161,193,178,194,198,166,206,194,190,208,166,196,187,205,196,202,206,178,208,226,215,222,164,214,211,224,226,197,217,226,157,219,
                         203,219,222,218,227,239,234,277,279,206,173,186,192,165,232,216,233,253,199,219,231,236,248,263,256,227,265,273,237,269,256,275,261,267,277,264,253,276,261,298,286,282,295,307,302,289,294,288,290,268,280,300,267,279,282,277,
                         289,282,274,285,250,290,270,275,303,272,287,264,275,290,279,305,304,300,315,264,258,291,290,298,276,286,305,299,292,279,305,281,316,324,271,332,291,272,318,284,287,304,308,300,280,333,308,300,303,288,315,310,304,320,282,345,
                         310,315,327,298,330,319,332,314,304,318,313,321,344,316,333,332,337,336,311,312,296,328,336,291,347,328,326,333,321,359,330,337,363,347,360,384,349,324,278,283,293,328,343,299,353,338,330,341,336,365,349,361,369,336,360,364,
                         360,367,322,379,366,369,385,367,374,358,378,379,368,409,381,409,400,383,379,372,396,383,334,384,363,365,375,386,369,370,363,359,349,394,349,360,360,326,366,344,377,370,393,368,351,382,364,365,375,353,363,372,378,364,371,357,
                         387,373,376,361,390,365,342,376,351,364,387,345,389,344,410,374,345,374,375,357,376,386,370,352,397,377,367,399,366,384,350,391,382,364,402,378,401,395,383,333,392,377,420,370,399,384,403,418,382,395,401,407,395,395,399,407,
                         409,441,418,442,383,359,347,347,381,370,383,395,376,351,401,411,424,389,426,410,403,430,428,406,415,443,421,395,439,430,438,431,435,438,418,462,448,438,448,427,441,452,446,452,436,449,424,432,450,434,429,428,426,420,403,420,
                         432,386,422,417,416,431,379,406,426,419,415,394,411,407,429,421,400,435,415,427,433,442,435,420,403,432,433,433,411,434,432,415,437,411,416,426,404,423,419,385,431,424,408,411,436,432,415,416,411,434,416,364,428,412,441,426,444,436,421,464,411,433,439,424,426,441,411,430,408,438,433,363,448,412,442,424,399,424,438,467,482,432,416,372,403,419,456,431,424,443,443,449,442,428,436,439,468,445,436,450,436,453,451,454,456,443,462,461,443,456,457,482,457,417,451,459,439,452,468,479,471,474,479,452,450,466,449,457,438,445,440,459,415,448,463,448,432,444,424,438,440,472,465,420,455,441,469,431,457,449,437,454,452,430,454,444,459,455,438,470,455,457,460,341,451,445,447,447,445,444,440,448,438,462,481,441,461,459,455,454,429,450,474,459,463,450,447,450,463,479,448,441,467,427,474,455,450,434,455,461,444,453,461,428,442,442,457,455,460,470,452,486,505,485,451,382,413,426,447,477,455,480,471,418,449,446,465,470,459,478,431,475,488,468,470,461,454,
  487,506,514,472,489,503,503,483,480,505,509,468,512,480,510,484,490,468,455,495,487,483,475,442,471,475,491,471,469,479,477,487,479,446,456,467,459,456,442,457,430,487,480,463,482,471,475,470,446,478,474,447,468,462,476,469,453,516,452,466,436,465,485,446,479,455,475,471,467,468,469,478,487,473,473,462,475,491,465,466,466,479,485,454,465,463,472,475,465,485,473,486,478,432,466,459,473,478,466,471,459,475,480,443,470,482,544,523,476,426,403,424,446,338,456,455,480,487,449,462,459,476,473,486,488,461,468,482,460,485,465,495,478,495,510,466,485,502,499,501,487,512,519,471,520,500,538,512,467,510,484,490,507,422,494,466,472,459,459,480,463,487,470,458,465,452,502,460,482,458,452,477,470,447,467,450,447,468,467,492,454,446,458,485,489,460,485,471,466,465,455,463,453,472,475,452,462,452,473,480,445,455,463,445,456,458,464,451,468,495,457,472,470,472,476,450,481,487,459,465,454,432,454,473,487,456,487,498,468,422,386,412,431,446,471,456,457,472,469,472,446,456,470,
  459,481,471,468,469,467,477,473,490,465,484,464,477,506,477,479,494,468,488,479,481,488,524,497,484,481,481,503,495,453,463,483,491,451,424,447,442,468,463,453,451,463,450,466,443,443,452,463,460,453,465,456,461,456,420,449,457,437,466,438,458,458,437,450,439,440,449,446,467,426,446,448,462,451,431,440,462,472,434,443,448,442,456,435,434,450,429,453,448,430,468,434,462,446,425,466,462,490,476,458,500,451,429,413,372,392,436,440,431,423,432,461,466,457,429,448,454,476,477,436,462,456,467,475,437,448,438,461,460,442,447,463,459,407,445,475,455,467,461,452,441,473,461,429,436,448,448,426,432,394,448,441,429,434,433,436,427,437,421,431,444,415,455,416,424,440,416,425,429,414,431,441,428,430,408,419,433,435,450,366,446,445,445,438,411,442,420,427,430,420,438,409,421,438,405,416,426,436,431,436,436,426,435,427,399,414,413,427,427,430,430,402,417,431,415,448,453,442,396,351,387,358,411,406,417,428,426,384,424,431,423,403,429,411,396,421,405,432,427,443,430,420,435,
  433,416,438,418,443,451,446,442,424,439,438,458,431,423,445,445,360,424,400,438,409,433,420,393,397,411,397,412,390,414,367,411,418,397,398,400,419,366,397,380,412,420,400,384,411,408,394,432,383,393,415,388,420,387,401,380,409,408,389,404,404,408,418,381,385,390,411,415,401,400,391,346,406,382,382,410,400,413,360,411,401,390,402,381,396,383,401,391,383,419,377,427,440,392,456,378,349,339,353,390,386,417,384,401,389,393,376,408,383,380,394,406,399,343,390,383,394,395,408,375,403,406,394,385,433,417,427,410,393,421,407,439,431,423,414,405,417,410,387,402,392,396,388,361,396,371,362,390,391,371,371,382,396,328,390,383,405,384,398,403,378,397,364,389,392,360,384,384,402,399,361,405,382,386,399,360,352,391,376,350,361,384,382,355,382,371,358,383,373,362,369,383,381,391,382,369,386,387,370,403,351,397,391,360,402,361,357,380,381,389,374,373,348,370,379,360,370,367,388,396,364,367,396,426,427,357,334,326,325,308,338,359,369,374,375,360,363,372,382,372,308,354,374,
  366,386,368,370,364,399,398,376,377,386,390,357,353,389,397,398,362,399,388,399,396,365,398,397,376,385,384,322,385,346,355,384,359,369,338,347,335,319,363,348,363,351,326,345,358,335,375,354,355,338,362,367,332,379,324,342,364,365,356,355,342,358,330,347,321,354,345,333,328,343,354,354,324,365,341,347,333,317,346,346,345,361,377,332,338,316,338,347,357,336,349,349,385,349,331,350,346,319,359,340,339,357,340,331,336,331,341,335,353,326,344,338,339,338,321,369,343,368,416,365,333,298,277,291,293,334,339,354,345,329,346,344,304,309,320,345,341,362,349,334,371,339,359,338,341,354,355,337,386,351,360,343,347,380,337,365,352,363,379,352,356,362,357,379,333,343,341,350,316,327,351,324,330,331,331,342,325,290,328,299,331,311,331,330,284,321,319,333,344,310,327,328,330,328,320,274,282,321,322,338,306,306,334,325,283,318,315,299,320,316,320,318,313,330,312,328,304,314,329,318,323,313,320,305,293,320,291,302,314,314,327,312,330,312,336,320,310,318,309,303,326,312,273,
  331,315,305,293,320,304,288,311,339,352,338,253,269,240,274,288,321,299,286,292,305,326,317,293,293,311,330,325,291,301,321,321,356,293,307,302,344,318,259,324,329,343,342,318,327,333,313,341,322,323,324,326,332,312,289,303,297,320,288,325,292,295,314,281,317,284,285,289,274,304,289,287,295,279,294,303,289,315,283,293,307,302,285,285,325,281,271,287,285,292,288,295,281,286,302,294,309,305,279,310,296,321,301,266,279,279,275,303,276,301,284,286,295,258,274,296,299,288,264,283,276,261,314,298,290,302,298,307,254,313,277,288,298,250,274,283,291,283,276,303,274,283,295,265,338,320,330,283,224,238,243,268,294,269,301,271,283,272,273,302,266,286,284,282,293,292,299,302,245,311,271,302,288,314,295,293,308,290,334,309,301,331,315,311,300,297,323,299,304,301,286,292,272,303,272,271,296,278,275,276,267,256,281,278,270,254,307,275,260,289,268,284,279,273,260,253,259,273,272,305,254,281,274,292,254,260,265,272,262,285,272,249,279,295,282,254,289,272,268,270,262,281,264,
  296,268,246,276,276,291,295,257,248,283,251,254,268,272,248,269,245,238,260,266,276,239,273,279,271,283,272,265,263,252,230,280,268,278,273,285,288,287,292,231,212,214,224,195,252,259,260,244,259,266,278,284,246,285,261,266,273,227,287,277,283,252,300,296,268,266,265,282,291,259,295,298,302,330,277,296,311,313,305,287,301,274,284,286,270,277,271,258,279,247,265,275,254,290,258,277,267,230,269,260,273,271,204,291,256,277,275,291,282,257,261,245,269,284,258,262,280,260,260,255,283,254,260,288,252,267,257,266,296,258,248,283,287,266,263,266,264,275,279,254,289,271,269,242,254,288,256,288,289,250,291,280,263,256,268,282,257,278,288,243,273,280,293,308,251,291,267,255,294,301,332,272,231,233,186,254,245,281,266,251,250,275,282,276,256,283,263,297,259,265,278,280,269,291,272,283,276,275,283,285,301,283,312,292,264,290,291,337,290,318,294,287,297,289,291,295,283,271,267,307,280,262,271,278,262,253,249,256,277,250,275,260,254,268,273,244,252,267,270,261,284,242,241,
  256,276,280,241,264,265,265,277,259,243,261,204,268,246,298,256,242,269,256,254,285,234,264,230,268,261,267,251,250,274,259,277,257,229,274,268,289,284,254,267,257,266,264,252,241,248,239,256,244,258,243,246,310,276,289,272,208,202,185,226,235,220,260,241,282,258,257,282,242,258,276,308,270,250,271,267,272,266,243,264,271,272,292,265,285,267,298,291,277,277,296,266,293,278,283,277,289,290,260,269,268,257,267,240,253,254,253,253,233,263,243,256,241,262,235,232,243,263,234,247,244,262,264,249,270,251,262,256,228,254,241,253,248,221,241,235,264,261,249,246,266,257,246,250,276,227,257,256,242,256,258,242,256,261,259,238,243,272,236,251,251,251,263,247,232,248,254,275,224,283,252,283,255,243,273,231,254,265,197,267,252,285,285,279,314,250,214,200,185,223,239,287,258,266,264,251,256,271,247,290,236,279,257,265,290,243,274,273,280,279,260,268,275,268,306,268,285,290,280,284,284,285,296,299,296,266,275,287,296,275,254,284,270,215,260,245,256,264,259,276,232,255,238,
  236,242,228,254,229,267,264,232,271,256,228,260,235,258,252,262,251,250,262,254,270,272,238,239,260,260,252,255,260,276,266,266,249,279,242,230,273,244,268,235,246,253,228,227,248,232,281,228,264,258,278,266,251,231,229,236,241,252,264,226,261,249,255,276,251,267,310,248,254,197,181,210,146,227,247,254,249,259,273,240,263,272,256,270,254,263,260,266,272,245,255,267,281,263,264,265,286,262,276,269,258,285,254,304,272,280,269,283,294,257,279,267,275,248,245,256,242,241,267,211,244,236,256,243,231,235,220,264,235,208,241,250,285,243,228,233,235,244,252,228,247,241,223,226,220,248,233,239,238,226,202,237,257,232,223,243,248,189,245,217,230,242,237,237,203,237,250,236,243,230,199,242,218,214,212,248,235,187,211,228,229,219,193,212,234,264,278,255,240,176,185,172,231,208,225,240,181,234,244,216,235,225,247,235,203,259,221,240,228,238,230,242,256,246,257,273,259,256,257,227,260,266,265,279,266,254,268,289,265,245,267,252,200,261,256,249,220,230,249,197,240,228,219,
  237,238,226,228,243,218,212,244,223,235,234,197,246,228,210,237,228,232,225,248,234,226,243,214,188,235,212,250,232,237,244,224,235,228,222,234,248,242,226,237,237,245,219,229,250,249,244,231,219,230,243,240,247,219,221,232,245,223,227,252,248,232,259,266,250,219,116,178,181,218,224,216,233,218,233,214,239,246,215,256,213,264,249,218,237,241,232,256,231,193,244,244,244,241,248,257,281,270,226,270,267,272,257,234,294,261,276,244,237,262,229,238,244,216,208,234,279,238,223,231,206,222,225,207,223,228,213,233,208,235,229,199,211,213,224,221,219,251,208,225,222,248,221,210,218,217,247,228,206,219,222,219,236,216,230,230,235,218,198,233,223,229,207,211,219,219,224,228,235,217,202,220,252,233,240,217,227,235,230,208,233,211,218,230,243,211,241,283,241,234,191,184,167,164,223,203,229,205,223,226,204,244,231,200,235,211,221,229,131,249,216,240,252,243,239,225,240,233,247,237,238,258,242,252,255,242,274,257,228,261,220,247,238,208,251,216,241,241,197,225,189,229,217,234,194,195,218,193,195,225,188,212,197,225,233,177,209,220,208,214,192,199,199,212,204,198,212,219,205,181,186,216,206,202,215,200,220,185,226,223,186,212,209,208,209,192,210,194,187,185,197,191,192,195,226,154,206,208,212,195,192,227,215,213,209,204,207,196,186,219,180,200,211,214,179,202,208,215,260,260,166,149,155,169,174,193,204,204,199,201,221,218,205,235,196,231,231,223,221,229,217,212,218,245,232,232,223,218,234,243,245,245,231,252,264,196,245,213,255,250,226,244,219,241,245,192,218,208,205,222,208,217,197,203,211,191,202,177,219,189,175,213,202,221,184,186,195,191,189,210,195,209,191,197,208,238,225,190,211,203,197,191,195,217,191,226,224,178,216,218,173,234,186,198,218,230,191,180,211,202,191,230,192,214,198,238,223
}; 
int completeflag = 0;

void ECG_GetValue()
{
  HAL_ADC_Start_DMA(&hadc1,(uint32_t*)data,30);
}

void ECG_RwaveDetect()
{
  

}

void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc)
{
 
  completeflag++;
}  
